<!doctype html>
<html>

	<head>
		<meta charset="UTF-8">
		<title>附近</title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<link href="css/mui.min.css" rel="stylesheet" />
		<link rel="stylesheet" type="text/css" href="css/common.css"/>
		<link rel="stylesheet" type="text/css" href="css/find.css"/>
		<style type="text/css">
			.shop_list{
				top: 0;
			}
		</style>
	</head>

	<body>
		<div class="mui-content">
		    <!--<div class="tuijian_list">
		    	<div class="find_title">
		    		周边品质好店
		    	</div>
		    	<ul class="tuijian__ul">
	    	        <li class="tuijian_item">
	    	            <a class="">
	    	               <img src="image/shop_2.png" class="tuijian_shop_logo"/>
	    	               <span class="tuijian_juli" >100m</span>
	    	               <div class="tuijian_shop">
	    	               		爱丽丝餐厅
	    	               		<span>
	    	               			<img src="image/icon1.png"/>
	    	               			<img src="image/icon1.png"/>
	    	               			<img src="image/icon1.png"/>
	    	               			<img src="image/icon1.png"/>
	    	               			<img src="image/icon2.png"/>
	    	               		</span>
	    	               </div>
	    	            </a>
	    	        </li>
	    	        <li class="tuijian_item">
	    	            <a class="">
	    	               <img src="image/shop_2.png" class="tuijian_shop_logo"/>
	    	               <span class="tuijian_juli" >100m</span>
	    	               <div class="tuijian_shop">
	    	               		爱丽丝餐厅
	    	               		<span>
	    	               			<img src="image/icon1.png"/>
	    	               			<img src="image/icon1.png"/>
	    	               			<img src="image/icon1.png"/>
	    	               			<img src="image/icon1.png"/>
	    	               			<img src="image/icon2.png"/>
	    	               		</span>
	    	               </div>
	    	            </a>
	    	        </li>
	    	        <li class="tuijian_item">
	    	            <a class="">
	    	               <img src="image/shop_2.png" class="tuijian_shop_logo"/>
	    	               <span class="tuijian_juli" >100m</span>
	    	               <div class="tuijian_shop">
	    	               		爱丽丝餐厅
	    	               		<span>
	    	               			<img src="image/icon1.png"/>
	    	               			<img src="image/icon1.png"/>
	    	               			<img src="image/icon1.png"/>
	    	               			<img src="image/icon1.png"/>
	    	               			<img src="image/icon2.png"/>
	    	               		</span>
	    	               </div>
	    	            </a>
	    	        </li>
	    	    </ul>
		    </div>-->
		    <div class="shop_list">
		    	<div id="slider" class="mui-slider mui-fullscreen">
				<div id="sliderSegmentedControl" class="mui-scroll-wrapper mui-slider-indicator mui-segmented-control mui-segmented-control-inverted">
					<div class="mui-scroll" id="shop_type">
						<a class="mui-control-item shop_type mui-active" href="#item1mobile">
							全部
						</a>
						<a class="mui-control-item shop_type" href="#item2mobile">
							美味
						</a>
						<a class="mui-control-item shop_type" href="#item3mobile">
							酒店
						</a>
						<a class="mui-control-item shop_type" href="#item4mobile">
							定制
						</a>
						<a class="mui-control-item shop_type" href="#item5mobile">
							旅游
						</a>
						<a class="mui-control-item shop_type" href="#item6mobile">
							生活
						</a>
					</div>
				</div>
				<div class="mui-slider-group">
					<div id="item1mobile" class="mui-slider-item mui-control-content mui-active">
						<div id="scroll1" class="mui-scroll-wrapper">
							<div class="mui-scroll">
								<ul class="mui-table-view">
									<li class="mui-table-view-cell shop_item">
										<div class="shop_item_i shop_img">
											<img  class="shop_logo" data-lazyload="image/shop_2.png"/>
										</div>
										<div class="shop_item_i shop_msg">
											<ul>
												<li class="shop_title">这是一家全部店铺</li>
												<li class="shop_pro">这里描述的不多，最多两行，多了这行</li>
												<li>
													<span class="shop_status">休息中</span>
													<span class="shop_juli">11.49km</span>
												</li>
												<li>
													<div class="shop_pingfen">
														<img src="image/icon1.png"/>
														<img src="image/icon1.png"/>
														<img src="image/icon1.png"/>
														<img src="image/icon1.png"/>
														<img src="image/icon2.png"/>
													</div>
												</li>
											</ul>
										</div>
										<div class="clear"></div>
									</li>
									
									
								</ul>
							</div>
						</div>
					</div>
					<div id="item2mobile" class="mui-slider-item mui-control-content">
						<div class="mui-scroll-wrapper">
							<div class="mui-scroll">
								<ul class="mui-table-view">
									<li class="mui-table-view-cell shop_item">
										<div class="shop_item_i shop_img">
											<img  class="shop_logo" data-lazyload="image/shop_2.png"/>
										</div>
										<div class="shop_item_i shop_msg">
											<ul>
												<li class="shop_title">这是一家美味店铺</li>
												<li class="shop_pro">这里描述的不多，最多两行，多了这行</li>
												<li>
													<span class="shop_status">营业中</span>
													<span class="shop_juli">11.49km</span>
												</li>
												<li>
													<div class="shop_pingfen">
														<img src="image/icon1.png"/>
														<img src="image/icon1.png"/>
														<img src="image/icon1.png"/>
														<img src="image/icon1.png"/>
														<img src="image/icon2.png"/>
													</div>
												</li>
											</ul>
										</div>
										<div class="clear"></div>
									</li>
									
								</ul>
							</div>
						</div>
					</div>
					<div id="item3mobile" class="mui-slider-item mui-control-content">
						<div class="mui-scroll-wrapper">
							<div class="mui-scroll">
								<ul class="mui-table-view">
									
									
								</ul>
							</div>
						</div>
					</div>
					<div id="item4mobile" class="mui-slider-item mui-control-content">
						<div class="mui-scroll-wrapper">
							<div class="mui-scroll">
								<ul class="mui-table-view">
									
									
								</ul>
							</div>
						</div>
					</div>
					<div id="item5mobile" class="mui-slider-item mui-control-content">
						<div class="mui-scroll-wrapper">
							<div class="mui-scroll">
								<ul class="mui-table-view">
									
									
								</ul>
							</div>
						</div>
					</div>
					<div id="item6mobile" class="mui-slider-item mui-control-content">
						<div class="mui-scroll-wrapper">
							<div class="mui-scroll">
								<ul class="mui-table-view">
									
									
									
								</ul>
							</div>
						</div>
					</div>
				</div>
			</div>
		    </div>
		</div>
		
	</body>

</html>
<script src="js/mui.min.js"></script>
<script src="js/jquery-1.10.1.min.js" type="text/javascript" charset="utf-8"></script>
<script src="js/mui.pullToRefresh.js"></script>
<script src="js/mui.pullToRefresh.material.js"></script>
<script src="js/mui.lazyload.js" type="text/javascript" charset="utf-8"></script>
<script src="js/mui.lazyload.img.js" type="text/javascript" charset="utf-8"></script>
<script>
			mui.init();
			(function($) {
				//阻尼系数
				var deceleration = mui.os.ios?0.003:0.0009;
				$('.mui-scroll-wrapper').scroll({
					bounce: false,
					indicators: true, //是否显示滚动条
					deceleration:deceleration
				});
				var scroller =[];
				$.ready(function() {
					//循环初始化所有下拉刷新，上拉加载。
					$.each(document.querySelectorAll('.mui-slider-group .mui-scroll'), function(index, pullRefreshEl) {
						$(pullRefreshEl).pullToRefresh({
							up: {
								callback: function() {
									var self = this;
									scroller.push(this);
									console.log(scroller)
									alert(index)
									setTimeout(function() {
										var ul = self.element.querySelector('.mui-table-view');
										ul.appendChild(createFragment(ul, index, 5));
										lazyLoad.refresh(true);
										self.endPullUpToRefresh();
									}, 1000);
								}
							}
						});
					});
					document.querySelector('.mui-slider').addEventListener('slide', function(event) {
					  //注意slideNumber是从0开始的；
					  var index_s=event.detail.slideNumber;
					    $.each(document.querySelectorAll('.mui-slider-group .mui-scroll'), function(index, pullRefreshEl) {
							//console.log(pullRefreshEl)
							if (index_s==index) {
								//var self=this;
								//console.log()
								var ul = pullRefreshEl.querySelector('.mui-table-view');
								if (ul.children.length==0) {
									scroller[index].pullToRefresh().pullupLoading();
									//ul.appendChild(createFragment(ul, index, 5));
								}
							}
						});
					});
					var createFragment = function(ul, index, count, reverse) {
						var length = ul.querySelectorAll('li').length;
						var fragment = document.createDocumentFragment();
						var li;
						for (var i = 0; i < count; i++) {
							li = document.createElement('li');
							li.className = 'mui-table-view-cell shop_item';
							li.innerHTML = '<div class="shop_item_i shop_img">'
										+		'<img src="image/shop_2.png"  class="shop_logo" data-lazyload="image/shop_2.png">'
										+	'</div>'
										+	'<div class="shop_item_i shop_msg">'
										+		'<ul>'
										+			'<li class="shop_title">这是一家'+index+'店铺'+i+'</li>'
										+			'<li class="shop_pro">这里描述的不多，最多两行，多了这行</li>'
										+			'<li>'
										+				'<span class="shop_status">营业中</span>'
										+				'<span class="shop_juli">11.49km</span>'
										+			'</li>'
										+			'<li>'
										+				'<div class="shop_pingfen">'
										+					'<img src="image/icon1.png">'
										+					'<img src="image/icon1.png">'
										+					'<img src="image/icon1.png">'
										+					'<img src="image/icon1.png">'
										+					'<img src="image/icon2.png">'
										+				'</div>'
										+			'</li>'
										+		'</ul>'
										+	'</div>'
										+	'<div class="clear"></div>'
							fragment.appendChild(li);
							
						}
						return fragment;
					};
					
				});
			})(mui);
			mui('#scroll1').on('tap','li',function(){
				location.href="shop_detail.html"
			})
			var lazyLoad= mui('.shop_list').imageLazyload({
		    	placeholder: 'image/index_shop_log.png',
		        destroy: false
			});
			
		</script>